<html>

<head>
<script src="js/jquery.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
 <!-- Compiled and minified CSS -->
<link rel="stylesheet" href="css/materialize.min.css">

<!-- Compiled and minified JavaScript -->
<script src="js/materialize.min.js"></script>


<style type="text/css">
html {
	scroll-behavior: smooth;
	font-family:Arial, Helvetica, sans-serif;
	color:#333333;
 
  
}
#map {
        height: 100%;
      }
div{
	
}
table{
	 font-size:12pt;	
}

.footer {
	position: fixed;
	left: 0;
	bottom: 0;
	width: 100%;
	background-color: #FF0E0E;
	color: white;
	text-align: center;
	padding-top:10px;
	padding-bottom:10px;
	font-size:30px;
}

.carousel-item{
	background-color:#FFFFFF;
	padding:5px;
	box-shadow: 0px 1px 5px #666666;
	border-radius:3px 3px 3px;
}
</style>

</head>
<body style="margin:0" onload="jInitMe()">
<div style="margin:0px" align="center">
	<div id="map"></div>
    
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBmoBX_A2XgfG2_CO5TVbJtZEStOT14uzc&callback=initMap"
    async defer></script>
</div>
<div id="DivCarousel" class="carousel" style="position:fixed;bottom:0px;margin-bottom:-20px" onfocus="" >

</div>
<div class="footer">
	<table style="width:100%">
		<tr align="center" style="border:none">
			<td style="width:20%;text-align:center;padding:0px">
			<img alt="" src="img/Discover1.png" style="width:55%;padding:0px"></td>
			<td style="width:20%;text-align:center;padding:0px;border:0px">
			<img alt="" src="img/Deals.png" style="width:55%"></td>
			<td style="width:20%;text-align:center;padding:0px;border:0px">
			<img alt="" src="img/ARCam.png" style="width:55%"></td>
			<td style="width:20%;text-align:center;padding:0px;border:0px">
			<img alt="" src="img/Essentials.png" style="width:55%"></td>
			<td style="width:20%;text-align:center;padding:0px;border:0px">
			<img alt="" src="img/Pass.png" style="width:55%"></td>
		</tr>	
		<tr align="center" style="font-size:10pt;font-weight:bold;color:#FFFFFF;border:none">
			<td style="color:#000000;text-align:center;padding:0px;border:none">Discover</td>
			<td style="text-align:center;padding:0px;border:none">Deals</td>
			<td style="text-align:center;padding:0px;border:none">AR.GO</td>
			<td style="text-align:center;padding:0px;border:none">Essentials</td>
			<td style="text-align:center;padding:0px;border:none">My Trip</td>
		</tr>
	</table>
</div></body>
<script type="text/javascript">

var markers = [];  
  
var map;
function initMap() {
	var xhttp = new XMLHttpRequest();
	xhttp.onreadystatechange = function() {
		if (this.readyState == 4 && this.status == 200) {
			//alert(this.responseText)
			var obj = JSON.parse(this.responseText)
			//var locations = [,['Tintin Shop',1.2832674,103.8425863, 4],['Keong Saik Road',1.2808043,103.8395402, 4],];
			//alert(obj.Loc)
			//x=[['Thian Hock Keng Temple',1.2812037,103.8431818, 4],['Tintin Shop',1.2832674,103.8425863, 4],['Casserole',1.2577377,103.8076075,4]]
			var locations = obj.Loc
			var map = new google.maps.Map(document.getElementById('map'), {
				zoom: 15,
				center: new google.maps.LatLng(obj.Lat,obj.Long),
				mapTypeId: google.maps.MapTypeId.ROADMAP
				});
			
			var infowindow = new google.maps.InfoWindow();
			
			var i;
			
			for (i = 0; i < locations.length; i++) {  
				var MarkerIndex=locations[i][4];
				markers[MarkerIndex] = new google.maps.Marker({
					position: new google.maps.LatLng(locations[i][1], locations[i][2]),
					map: map,
				});
				
				(function(marker,i){
					google.maps.event.addListener(marker, 'click', function(){ 
						infowindow.setContent(locations[i][0]);
						infowindow.open(map, marker);
					}); 
				}(markers[MarkerIndex],i));
			}

		}
	}
	var URL="http://argo-app.ddns.net/csp/argo/app/MapSearch.csp?d1=Map"
	xhttp.open("GET", URL, true);
	xhttp.send();

	
}


function jInitMe(){
	var xhttp = new XMLHttpRequest();
	xhttp.onreadystatechange = function() {
		if (this.readyState == 4 && this.status == 200) {
			document.getElementById('DivCarousel').innerHTML=this.responseText	
			
			document.addEventListener('DOMContentLoaded', function() {
				var elems = document.querySelectorAll('.carousel');
				var instances = M.Carousel.init(elems, options);
			});
			
			// Or with jQuery
			
			$(document).ready(function(){
			
				 $('.carousel').carousel({
				    duration: 100,
				    indicators: true,
				    onCycleTo: function(data) {
				      jPopPin(data.id)
				   }
				});
			});
		}
	}
	var URL="http://argo-app.ddns.net/csp/argo/app/MapSearch.csp?d1=Carousel"
	xhttp.open("GET", URL, true);
	xhttp.send();

}

function jPopPin(val){
	google.maps.event.trigger(markers[val], 'click');

}
</script>
</html>
